# WebSocket 压力测试工具使用指南

## 快速开始

### 1. 基本测试
```bash
# 使用默认参数进行测试
go run main.go
```

### 2. 查看帮助
```bash
go run main.go -h
```

## 参数说明

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `-clients` | 10 | 并发客户端连接数量 |
| `-mps` | 1 | 每秒发送消息数量 |
| `-duration` | 1m | 测试持续时间 |
| `-conn-timeout` | 10s | 连接超时时间 |
| `-resp-timeout` | 1s | 响应超时时间 |
| `-ramp-up` | 10s | 连接建立阶段时间 |
| `-msg-size` | 100 | 消息大小(字节) |
| `-server` | ws://localhost:9002/ws | WebSocket服务器地址 |


## 输出说明

### 实时统计信息
```
=== 统计信息 ===
总连接数: 1000
活跃连接数: 998
总消息数: 5000
成功消息数: 4980
失败消息数: 20
运行时间: 1m30s
消息速率: 55.56 msg/s
成功率: 99.60%
================
```

### 日志信息
- 连接建立过程
- 消息发送状态
- 错误信息
- 测试完成统计

## 性能指标

### 关键指标
1. **连接成功率**: 成功建立的连接数 / 总连接数
2. **消息成功率**: 成功发送的消息数 / 总消息数
3. **消息吞吐量**: 每秒处理的消息数
4. **响应时间**: 消息发送到接收确认的时间

### 优化建议
1. 根据服务器性能调整客户端数量
2. 监控内存和CPU使用率
3. 注意网络带宽限制
4. 合理设置超时时间

## 故障排除

### 常见问题
1. **连接失败**: 检查服务器地址和端口
2. **认证失败**: 检查JWT token配置
3. **消息超时**: 调整响应超时时间
4. **内存不足**: 减少并发客户端数量

### 调试模式
```bash
# 使用少量客户端进行调试
go run main.go -clients=5 -mps=1 -duration=30s
``` 